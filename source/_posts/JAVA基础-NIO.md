---
title: JAVA基础-NIO
tags: JAVA基础
toc: true
---

# 含义
IO，指的是计算机与外部世界或者一个程序与计算机的其余部分的之间的接口。
JAVA中，传统IO使用流的方式来完成IO。IO都视为单个字节的移动，通过Stream对象一次一个字节（即使是字符流，也是依赖字节流）。
NIO创建的目的是为了实现高速IO，无需编写自定义的本机代码，将最耗时的 I/O 操作(即填充和提取缓冲区)转移回操作系统，因而可以极大地提高速度。

# 比较
原来的I/O库(在`java.io.*`中)与NIO最重要的区别是数据打包和传输的方式。正如前面提到的，原来的I/O以流的方式处理数据，而NIO以块的方式处理数据。
面向流的I/O系统一次一个字节地处理数据。一个输入流产生一个字节的数据，一个输出流消费一个字节的数据。为流式数据创建过滤器非常容易。链接几个过滤器，以便每个过滤器只负责单个复杂处理机制的一部分，这样也是相对简单的。不利的一面是，面向流的I/O通常相当慢。
一个面向块的I/O系统以块的形式处理数据。每一个操作都在一步中产生或者消费一个数据块。按块处理数据比按(流式的)字节处理数据要快得多。但是面向块的I/O缺少一些面向流的I/O所具有的优雅性和简单性。

- 在JDK1.4中原来的I/O包和NIO已经很好地集成了。 `java.io.*`已经以NIO为基础重新实现了，所以现在它可以利用NIO的一些特性。例如，`java.io.*`包中的一些类包含以块的形式读写数据的方法，这使得即使在更面向流的系统中，处理速度也会更快。
- 也可以用NIO库实现标准I/O功能。例如，可以容易地使用块I/O一次一个字节地移动数据。

# 通道`Channels`和缓冲区`Buffers`
NIO中的核心就是`Channels`和`Buffers`。`Channels`模拟的是原IO中的流的概念，到任何目的地或是来自任何地方的所有数据都必须通过一个`Channels`对象。`Buffers`对象实际上作为一个容器，所有发送到`Channels`的数据必须先放到`Buffers`，所有从`Channels`中读取的数据必须首先存储到`Buffers`。

## 缓冲区`Buffers`
`Buffers`是一个对象，包含要写入或读出的数据。在原IO中，数据是直接写入Stream或从Stream中读取，而在NIO中，所有数据都必须经过`Buffers`。
- 读取数据，是从缓冲区`Buffers`对象中读取数据；
- 写入数据，是将数据写入到缓冲区`Buffers`对象中；

缓冲区的本质是数组，但是提供了额外功能：对数据的结构化访问，跟踪读写进程。

### 缓冲区`Buffers`类型
- ByteBuffer（最常用）
- CharBuffer
- ShortBuffer
- IntBuffer
- LongBuffer
- FloatBuffer
- DoubleBuffer

每一个 Buffer 类都是 Buffer 接口的一个实例。 除了 ByteBuffer，每一个 Buffer 类都有完全一样的操作，只是它们所处理的数据类型不一样。

## 通道`Channels`
通道类似原IO中的流的概念，可以使用`Channel`来写入或读取数据，但是通道是双向的（可同时用于读或写），流是单向的。
一个或多个字节写入到缓冲区然后在写入到通道，或是从通道中读取一个或多个字节到缓冲区。